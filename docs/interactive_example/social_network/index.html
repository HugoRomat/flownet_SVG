
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Flownet</title>

      <script src="lib/three.min.js"></script>
      <script src="lib/jquery.min.js"></script>
      <script src="lib/d3.min.js"></script>
      <script src="lib/cola.min.js"></script>
      <script src="lib/Sparkiz.js"></script>
      <link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

    <style>
      body{
        font-family: 'Roboto', "Times", "Arial";
        margin:0;
      }
        div{
            float: left;
            margin-right: 5px;
        }
        #legend{
          position: absolute;
          top: 10%;
          width: 50%;
          /* text-align: center; */
          font-style: italic;
          font-size: 15px;
          margin-left: 10%;
          background-color: rgba(163, 163, 163, 0.5);
            padding: 15px;
        }



    </style>


</head>
<body>
  <div class="bandeau-top" style="position:absolute; top:0%;width:100%; height:20px; background-color:black; color:white; text-align: center; padding:7px;">
     Optimized for Chrome
     </div>
  <div id="legend">
    Messaging between actors across various social networks. Particles flow from one actor to another. Their size and frequency respectively encode the average size and frequency of messages between those actors
  </div>
  <div id="visFrame"></div>
     

  <script>
  var color_scale = d3.scale.linear()
                   .domain([1,4])
                   .range([d3.rgb("#ff0000"), d3.rgb('#fffe00')])
                

      var frequency_scale = d3.scale.linear()
                    .domain([10,100])
                    .range([0.1, 1.2])
      var size_scale = d3.scale.linear()
                    .domain([5,40])
                    .range([5, 18])


    d3.json("data_social_network.json", function(json) {

            var app = Sparkiz.force("#visFrame", 1300,1200,"#a6cee3", 0)
                .nodes(json.nodes)
                .links(json.links)
                .layout("linkDistance", 200)
                .create_layout()
                .zoom(true)
                .roads_mapping("number_roads", 1 )
                .links_mapping("courbure", 5)
                .create_WEBGL_element()

                .links_mapping("color", "#91bfdb")
                .links_mapping("size", 3)

                //.nodes_mapping("label", function(d, i) {return d.label; })
                .nodes_mapping("size",  20)
                .nodes_mapping("image", function(d, i) {return "images/" + d.label + ".jpg"; })

                .particle_mapping("color", '#1f253d')
                .particle_mapping("size", function(d, i) {return size_scale(d.size_message); })
                .particle_mapping("frequency_pattern", function(d, i) {return frequency_scale(d.frequency); })
                //.particle_mapping("frequency_pattern", 0.3)
                .particle_mapping("temporal_distribution", [0])
                .particle_mapping("velocity", 1 )
                .particle_mapping("texture", "images/rectangle_texture.png")
                .start_particle_delay(200000)
                .start(1000);
            


    });



  </script>


</body>
</html>
